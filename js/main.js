'use strict';var _get=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(e===void 0){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if('value'in e)return e.value;var g=e.get;return void 0===g?void 0:g.call(d)},_typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}(function(){'use strict';function a(a,b){return'string'==typeof a&&(a=document.querySelectorAll(a)),a instanceof Array||(a=Array.prototype.slice.call(a)),b instanceof Function&&(a=a.map(function(a){return b(a)})),a}function b(){var a=window,b=document,c=b.documentElement,d=b.getElementsByTagName('body')[0],e=a.innerWidth||c.clientWidth||d.clientWidth,f=a.innerHeight||c.clientHeight||d.clientHeight;return{width:e,height:f}}function c(c,d){var e=0|d.getAttribute('data-first');e&&c.goTo(e);var f=d.hasAttribute('data-options')?d.getAttribute('data-options').split(' '):[];f.forEach(function(a){return g[a]&&g[a](c)});var h={openOnMobile:function openOnMobile(){if(!(600<b().width)){var a=c.find(function(a){return'0'===a.getAttribute('data-order')});if(a){var d=a.querySelector('.info-img a[href^="javascript:"]');d&&d.click()}}}};a('[data-control]',function(a){var b=a.getAttribute('data-control'),d=b?document.querySelector(b):null;if(d&&d===c.parent){var e=a.getAttribute('data-action');('prev'===e||'next'===e)&&c.size>=c.length&&a.setAttribute('data-oversize',!0);var f=a.getAttribute('data-params'),g=f?f.split(','):null,i=a.getAttribute('data-callback');e&&c[e]instanceof Function&&a.addEventListener('click',function(){c[e].apply(c,g),i&&h[i]&&h[i]()})}})}var d=function(){function a(b){if(_classCallCheck(this,a),this.type='Slider',!(this instanceof a))return new a(b);if(this.parent=b.parent||document.querySelector(b.parentSelector||'.slider'),!this.parent)throw'[SLIDER]: Container n\xE3o encontrado.';if(this.childSelector=b.childSelector||'.slide',!this.children.length)throw'[SLIDER]: Slides n\xE3o encontrados.';this.index=0,this.duration=b.duration||3e3,this.parent.classList.add('set'),this.compose()}return _createClass(a,[{key:'forEach',value:function forEach(a){return this.children.forEach(a)}},{key:'map',value:function map(a){return this.children.map(a)}},{key:'filter',value:function filter(a){return this.children.filter(a)}},{key:'find',value:function find(a){return this.children.find(a)}},{key:'compose',value:function compose(){var a,b,c=this;return b=0<this.index?this.index-1:this.children.length-1,a=this.index<this.children.length-1?this.index+1:0,this.forEach(function(d,e){d.classList.remove('prev'),d.classList.remove('current'),d.classList.remove('next'),e===b&&d.classList.add('prev'),e===a&&d.classList.add('next'),e===c.index&&d.classList.add('current')}),this}},{key:'play',value:function play(){var a;return a=this,this.playingStateID=setInterval(function(){return a.next()},this.duration),this.isPlaying=!0,this}},{key:'pause',value:function pause(){return clearInterval(this.playingStateID),this.isPlaying=!1,this}},{key:'playpause',value:function playpause(){return this.isPlaying?this.pause():this.play()}},{key:'prev',value:function prev(){var a;if(0<this.index?this.index--:this.index=this.children.length-1,a=this.isPlaying,a&&this.pause(),this.compose(),a)return this.play()}},{key:'next',value:function next(){var a;if(this.index<this.children.length-1?this.index++:this.index=0,a=this.isPlaying,a&&this.pause(),this.compose(),a)return this.play()}},{key:'goTo',value:function goTo(a){return this.index=a,this.compose()}},{key:'on',value:function on(a,b){return this.parent.addEventListener(a,b),this}},{key:'off',value:function off(a,b){return this.parent.removeEventListener(a,b),this}},{key:'inspect',value:function inspect(a){var b=this;return console[!0===a?'groupCollapsed':'group'](this.type),console.table(Object.keys(this).map(function(a){return{prop:a,value:b[a],type:_typeof(b[a])}})),console.log(this.parent),console.log(this.children),console.warn(Date.now().toString()),console.groupEnd(this.type),this}},{key:'children',get:function get(){return Array.prototype.slice.call(this.parent.querySelectorAll(this.childSelector))}},{key:'length',get:function get(){return this.children.length}}]),a}(),e=function(a){function b(a){_classCallCheck(this,b),a.parentSelector=a.parentSelector||'.carousel';var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.type='Carousel',c.size=0|a.size,c.compose(),c}return _inherits(b,a),_createClass(b,[{key:'compose',value:function compose(){var b=this,c=this.index+1;function a(a,b){a.classList.remove(b)}return this.forEach(function(d,e){var f=e-c+1;if(0>f&&(f=b.length-c+e+1),d.setAttribute('data-order',f),d.classList.remove('prev'),d.classList.remove('current'),d.classList.remove('next'),d.classList.remove('will-go-prev'),d.classList.remove('will-go-next'),b.size){var g=b.length<=b.size?'current':-1<f&&f<b.size?'current':-1==f||f==b.length-1?'prev':f===b.size?'next':'';if(!g)return b;d.classList.add(g),d.style.order=f}if(b.dir){var h='will-go-'+b.dir;d.classList.add(h),d.addEventListener('webkitAnimationEnd',function(){a(d,h)}),d.addEventListener('animationend',function(){a(d,h)})}}),this}},{key:'prev',value:function prev(){return this.dir='prev',_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'prev',this).call(this)}},{key:'next',value:function next(){return this.dir='next',_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'next',this).call(this)}},{key:'goTo',value:function goTo(a){return this.dir=a>this.index?'next':'prev',_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),'goTo',this).call(this,a)}}]),b}(d),f={telefone:function telefone(a){var b=[/\d+/gi,/^(\d\d?)/,/^(\d\d)(\d{4})-?(\d{1,4})/,/^(\d\d)(\d{5})-?(\d{1,4})/],c=a.value.match(b[0]);if(!c)return a.value='';var d=a.value=c.join('');0<d.length&&(a.value=d.replace(b[1],'($1')),2<d.length&&(a.value=d.replace(b[1],'($1) ')),6<d.length&&(a.value=d.replace(b[2],'($1) $2-$3')),10<d.length&&(a.value=d.replace(b[3],'($1) $2-$3')),11<d.length&&(a.value=a.value.substr(0,15))},cpf:function(a){var b=/\d+/gi,c=a.value.match(b);if(!c)return a.value='';var d=c.join(''),e=/^([0-9]{1,3})?\.?([0-9]{1,3})?\.?([0-9]{1,3})?-?([0-9]{1,2})?$/,f=/^([0-9]{1,2})?\.?([0-9]{1,3})?\.?([0-9]{1,3})?\/?([0-9]{1,4})?-?([0-9]{1,2})?$/;a.value=a.value.replace(/[^\d./-]/gi,''),e.test(d)?a.value=d.replace(e,function(e,f,a,b,c){return(f||'')+(a?'.'+a:'')+(b?'.'+b:'')+(c?'-'+c:'')}):f.test(d)&&(a.value=d.replace(f,function(f,g,a,b,c,d){return(g||'')+(a?'.'+a:'')+(b?'.'+b:'')+(c?'/'+c:'')+(d?'-'+d:'')})),18<a.value.length&&(a.value=a.value.substr(0,18))},data:function data(a){if('date'!==a.type){var b=a.value.replace(/^0?\/|[^\d/]/gi,'');return''===b?(a.value=b,void(a.style.borderColor=null)):void(a.value=b.replace(/(^|\/)00+\/?/g,'0').replace(/(^|\/)([1-9]\/)/,'0$2').replace(/(\d\d)(\/?)(\d{1,2})?(\/?)0*(\d{1,4})?.*/g,function(b,c,d,e,f,g){return a.style.borderColor=31<c||12<e?'red':null,c+(e?'/'+e:d||'')+(g?'/'+g:f||'')}))}},numeros:function numeros(a){/^[0-9]+$/.test(a.value)||(a.value=a.value.substring(0,a.value.length-1))}},g={autoplay:function autoplay(a){a.play().on('mouseover',function(){return a.pause()}).on('mouseout',function(){return a.play()})}};window.setup=function(){document.body.addEventListener('touchstart',function(){return!1});var b=document.querySelector('.site-header').offsetHeight,g=document.querySelectorAll('a[href^="'+baseurl+'/#"].scroll');Array.prototype.forEach.call(g,function(a){return a.addEventListener('click',function(){var a=document.querySelector(this.hash);return!!a&&void scrollToY(a.offsetTop-b,1e3)})}),window.sliders=a('.slider',function(a){var b=new d({parent:a});c(b,a)}),window.carousels=a('.carousel',function(a){var b=0|a.getAttribute('data-size'),d=new e({parent:a,size:b});return c(d,a),d}),a('[data-mask]',function(a){var b=a.getAttribute('data-mask');b&&f[b]&&f[b]instanceof Function&&a.addEventListener('input',function(){f[b](a)})}),a('[data-script]',function(a){var b=a.getAttribute('data-script');b&&a.value&&window[b](0,a.value)})},window.modal=function(a){return'string'==typeof a&&(a=document.querySelector(a)),{abrir:function abrir(){a.classList.add('target')},fechar:function fechar(){a.classList.remove('target')}}}})();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiQXJyYXkiLCJwcm90b3R5cGUiLCJzbGljZSIsImNhbGwiLCJGdW5jdGlvbiIsIm1hcCIsIndpbmRvdyIsImRvY3VtZW50RWxlbWVudCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiaW5uZXJXaWR0aCIsImNsaWVudFdpZHRoIiwiaW5uZXJIZWlnaHQiLCJjbGllbnRIZWlnaHQiLCJ3aWR0aCIsImhlaWdodCIsImdldEF0dHJpYnV0ZSIsImdvVG8iLCJoYXNBdHRyaWJ1dGUiLCJzcGxpdCIsImZvckVhY2giLCJvcGVuT25Nb2JpbGUiLCJmaW5kIiwicXVlcnlTZWxlY3RvciIsImNsaWNrIiwicGFyZW50Iiwic2l6ZSIsImxlbmd0aCIsInNldEF0dHJpYnV0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJhcHBseSIsInR5cGUiLCJwYXJlbnRTZWxlY3RvciIsImNoaWxkU2VsZWN0b3IiLCJjaGlsZHJlbiIsImluZGV4IiwiZHVyYXRpb24iLCJjbGFzc0xpc3QiLCJhZGQiLCJjb21wb3NlIiwiZmlsdGVyIiwicmVtb3ZlIiwicGxheWluZ1N0YXRlSUQiLCJzZXRJbnRlcnZhbCIsIm5leHQiLCJpc1BsYXlpbmciLCJjbGVhckludGVydmFsIiwicGF1c2UiLCJwbGF5IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImNvbnNvbGUiLCJ0YWJsZSIsIk9iamVjdCIsImtleXMiLCJwcm9wIiwidmFsdWUiLCJsb2ciLCJ3YXJuIiwiRGF0ZSIsIm5vdyIsInRvU3RyaW5nIiwiZ3JvdXBFbmQiLCJzdHlsZSIsIm9yZGVyIiwiZGlyIiwidGVsZWZvbmUiLCJtYXRjaCIsImpvaW4iLCJyZXBsYWNlIiwic3Vic3RyIiwiY3BmIiwidGVzdCIsImRhdGEiLCJib3JkZXJDb2xvciIsIm51bWVyb3MiLCJzdWJzdHJpbmciLCJhdXRvcGxheSIsIm9uIiwic2V0dXAiLCJib2R5Iiwib2Zmc2V0SGVpZ2h0IiwiYmFzZXVybCIsImhhc2giLCJzY3JvbGxUb1kiLCJvZmZzZXRUb3AiLCJzbGlkZXJzIiwiY2Fyb3VzZWxzIiwibW9kYWwiLCJhYnJpciIsImZlY2hhciJdLCJtYXBwaW5ncyI6IjYwQ0FBQyxXQUFZLENBQ2IsYUE2UkEsZUFBOEIsQ0FJMUIsTUFIb0IsUUFBaEIsVUFHSixHQUg4QixFQUFPQSxTQUFTQyxnQkFBVCxHQUdyQyxFQUZNLFlBQWdCQyxNQUV0QixHQUY4QixFQUFPQSxNQUFNQyxTQUFOLENBQWdCQyxLQUFoQixDQUFzQkMsSUFBdEIsR0FFckMsRUFESSxZQUFvQkMsU0FDeEIsR0FEa0MsRUFBTyxFQUFLQyxHQUFMLENBQVMsa0JBQUssS0FBTCxDQUFULENBQ3pDLEdBQ0QsQ0FFRCxZQUFrQixDQUNoQixHQUFNLEdBQUlDLE1BQVYsQ0FDRSxFQUFJUixRQUROLENBRUUsRUFBSSxFQUFFUyxlQUZSLENBR0UsRUFBSSxFQUFFQyxvQkFBRixDQUF1QixNQUF2QixFQUErQixDQUEvQixDQUhOLENBSUUsRUFBUSxFQUFFQyxVQUFGLEVBQWdCLEVBQUVDLFdBQWxCLEVBQWlDLEVBQUVBLFdBSjdDLENBS0UsRUFBUyxFQUFFQyxXQUFGLEVBQWlCLEVBQUVDLFlBQW5CLEVBQW1DLEVBQUVBLFlBTGhELENBTUEsTUFBTyxDQUNMQyxPQURLLENBRUxDLFFBRkssQ0FJUixDQTZESCxlQUFzQyxDQUNwQyxHQUFNLEdBQTRDLENBQXBDLEdBQU9DLFlBQVAsQ0FBb0IsWUFBcEIsQ0FBZCxDQURvQyxHQUdsQyxFQUFPQyxJQUFQLEdBSGtDLENBTXBDLEdBQU0sR0FBVSxFQUFPQyxZQUFQLENBQW9CLGNBQXBCLEVBQXNDLEVBQU9GLFlBQVAsQ0FBb0IsY0FBcEIsRUFBb0NHLEtBQXBDLENBQTBDLEdBQTFDLENBQXRDLENBQXVGLEVBQXZHLENBQ0EsRUFBUUMsT0FBUixDQUFnQixrQkFBVSxPQUF5QixPQUFuQyxDQUFoQixDQVBvQyxDQVNwQyxHQUFNLEdBQWtCLENBQ3RCQyxhQUFjLHVCQUFNLENBQ2xCLEtB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LENBUmtCLENBckJKLENBK0JmLEVBQUssYUFBTCxDQUFvQixXQUFTLENBQzNCLEdBQU0sR0FBTyxFQUFNVixZQUFOLENBQW1CLFdBQW5CLENBQWIsQ0FEMkIsR0FHdEIsSUFBRCxFQUFrQixjQUF1QlgsU0FIbEIsRUFJM0IsRUFBTXdCLGdCQUFOLENBQXVCLE9BQXZCLENBQWdDLFVBQVksQ0FDMUMsT0FDRCxDQUZELENBR0QsQ0FQRCxDQS9CZSxDQXdDZixFQUFLLGVBQUwsQ0FBc0IsV0FBUSxDQUM1QixHQUFNLEdBQVUsRUFBS2IsWUFBTCxDQUFrQixhQUFsQixDQUFoQixDQUQ0QixHQUd2QixFQUFLdUMsS0FIa0IsRUFJNUJoRCxVQUFnQixDQUFoQixDQUFtQixFQUFLZ0QsS0FBeEIsQ0FDRCxDQUxELENBTUQsQ0F6V1ksQ0F3WmJoRCxPQUFPZ0YsS0FBUCxDQUFlLFdBQXNCLENBRW5DLE1BRHFCLFFBQWpCLFVBQ0osR0FEK0IsRUFBUXhGLFNBQVN3QixhQUFULEdBQ3ZDLEVBQU8sQ0FDTGlFLE1BQU8sZ0JBQVcsQ0FBQyxFQUFNbkQsU0FBTixDQUFnQkMsR0FBaEIsQ0FBb0IsUUFBcEIsQ0FBK0IsQ0FEN0MsQ0FFTG1ELE9BQVEsaUJBQVcsQ0FBQyxFQUFNcEQsU0FBTixDQUFnQkksTUFBaEIsQ0FBdUIsUUFBdkIsQ0FBa0MsQ0FGakQsQ0FJUixDQUVBLENBaGFBLEciLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7XG4ndXNlIHN0cmljdCc7XG5cbmNsYXNzIFNsaWRlciB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoY29uZmlnKSB7XHJcbiAgICAgIHRoaXMudHlwZSA9ICdTbGlkZXInO1xyXG4gICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgU2xpZGVyKSkgcmV0dXJuIG5ldyBTbGlkZXIoY29uZmlnKTtcclxuICBcclxuICAgICAgdGhpcy5wYXJlbnQgPSBjb25maWcucGFyZW50IHx8IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnBhcmVudFNlbGVjdG9yIHx8ICcuc2xpZGVyJyk7XHJcbiAgICAgIGlmICghdGhpcy5wYXJlbnQpIHRocm93ICdbU0xJREVSXTogQ29udGFpbmVyIG7Do28gZW5jb250cmFkby4nO1xyXG4gIFxyXG4gICAgICB0aGlzLmNoaWxkU2VsZWN0b3IgPSBjb25maWcuY2hpbGRTZWxlY3RvciB8fCAnLnNsaWRlJztcclxuICAgICAgaWYgKCF0aGlzLmNoaWxkcmVuLmxlbmd0aCkgdGhyb3cgJ1tTTElERVJdOiBTbGlkZXMgbsOjbyBlbmNvbnRyYWRvcy4nO1xyXG4gIFxyXG4gICAgICB0aGlzLmluZGV4ID0gMDtcclxuICAgICAgdGhpcy5kdXJhdGlvbiA9IGNvbmZpZy5kdXJhdGlvbiB8fCAzMDAwO1xyXG4gICAgICB0aGlzLnBhcmVudC5jbGFzc0xpc3QuYWRkKCdzZXQnKTtcclxuICAgICAgdGhpcy5jb21wb3NlKCk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBnZXQgY2hpbGRyZW4oKSB7XHJcbiAgICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0aGlzLnBhcmVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuY2hpbGRTZWxlY3RvcikpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgZ2V0IGxlbmd0aCgpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuY2hpbGRyZW4ubGVuZ3RoO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgZm9yRWFjaChmbikge1xyXG4gICAgICByZXR1cm4gdGhpcy5jaGlsZHJlbi5mb3JFYWNoKGZuKTtcclxuICAgIH1cclxuICBcclxuICAgIG1hcChmbikge1xyXG4gICAgICByZXR1cm4gdGhpcy5jaGlsZHJlbi5tYXAoZm4pO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgZmlsdGVyKGZuKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmNoaWxkcmVuLmZpbHRlcihmbik7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBmaW5kKGZuKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmNoaWxkcmVuLmZpbmQoZm4pO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgY29tcG9zZSgpIHtcclxuICAgICAgdmFyIG5leHRJbmRleCwgcHJldkluZGV4O1xyXG4gICAgICBwcmV2SW5kZXggPSB0aGlzLmluZGV4ID4gMCA/IHRoaXMuaW5kZXggLSAxIDogdGhpcy5jaGlsZHJlbi5sZW5ndGggLSAxO1xyXG4gICAgICBuZXh0SW5kZXggPSB0aGlzLmluZGV4IDwgdGhpcy5jaGlsZHJlbi5sZW5ndGggLSAxID8gdGhpcy5pbmRleCArIDEgOiAwO1xyXG4gICAgICB0aGlzLmZvckVhY2goKGVsLCBpKSA9PiB7XHJcbiAgICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSgncHJldicpO1xyXG4gICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ2N1cnJlbnQnKTtcclxuICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCduZXh0Jyk7XHJcbiAgICAgICAgaWYgKGkgPT09IHByZXZJbmRleCkgZWwuY2xhc3NMaXN0LmFkZCgncHJldicpO1xyXG4gICAgICAgIGlmIChpID09PSBuZXh0SW5kZXgpIGVsLmNsYXNzTGlzdC5hZGQoJ25leHQnKTtcclxuICAgICAgICBpZiAoaSA9PT0gdGhpcy5pbmRleCkgZWwuY2xhc3NMaXN0LmFkZCgnY3VycmVudCcpO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBwbGF5KCkge1xyXG4gICAgICB2YXIgdGhhdDtcclxuICAgICAgdGhhdCA9IHRoaXM7XHJcbiAgICAgIHRoaXMucGxheWluZ1N0YXRlSUQgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoYXQubmV4dCgpO1xyXG4gICAgICB9LCB0aGlzLmR1cmF0aW9uKTtcclxuICAgICAgdGhpcy5pc1BsYXlpbmcgPSB0cnVlO1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuICBcclxuICAgIHBhdXNlKCkge1xyXG4gICAgICBjbGVhckludGVydmFsKHRoaXMucGxheWluZ1N0YXRlSUQpO1xyXG4gICAgICB0aGlzLmlzUGxheWluZyA9IGZhbHNlO1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuICBcclxuICAgIHBsYXlwYXVzZSgpIHtcclxuICAgICAgaWYgKHRoaXMuaXNQbGF5aW5nKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGF1c2UoKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wbGF5KCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICBcclxuICAgIHByZXYoKSB7XHJcbiAgICAgIHZhciBwbGF5aW5nU3RhdGU7XHJcbiAgICAgIGlmICh0aGlzLmluZGV4ID4gMCkge1xyXG4gICAgICAgIHRoaXMuaW5kZXgtLTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmluZGV4ID0gdGhpcy5jaGlsZHJlbi5sZW5ndGggLSAxO1xyXG4gICAgICB9XHJcbiAgICAgIHBsYXlpbmdTdGF0ZSA9IHRoaXMuaXNQbGF5aW5nO1xyXG4gICAgICBpZiAocGxheWluZ1N0YXRlKSB7XHJcbiAgICAgICAgdGhpcy5wYXVzZSgpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuY29tcG9zZSgpO1xyXG4gICAgICBpZiAocGxheWluZ1N0YXRlKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucGxheSgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgXHJcbiAgICBuZXh0KCkge1xyXG4gICAgICB2YXIgcGxheWluZ1N0YXRlO1xyXG4gICAgICBpZiAodGhpcy5pbmRleCA8IHRoaXMuY2hpbGRyZW4ubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgIHRoaXMuaW5kZXgrKztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmluZGV4ID0gMDtcclxuICAgICAgfVxyXG4gICAgICBwbGF5aW5nU3RhdGUgPSB0aGlzLmlzUGxheWluZztcclxuICAgICAgaWYgKHBsYXlpbmdTdGF0ZSkge1xyXG4gICAgICAgIHRoaXMucGF1c2UoKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmNvbXBvc2UoKTtcclxuICAgICAgaWYgKHBsYXlpbmdTdGF0ZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBsYXkoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIFxyXG4gICAgZ29UbyhpbmRleCkge1xyXG4gICAgICB0aGlzLmluZGV4ID0gaW5kZXg7XHJcbiAgICAgIHJldHVybiB0aGlzLmNvbXBvc2UoKTtcclxuICAgIH1cclxuICBcclxuICAgIG9uKGV2ZW50LCBmbikge1xyXG4gICAgICB0aGlzLnBhcmVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBmbik7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgb2ZmKGV2ZW50LCBmbikge1xyXG4gICAgICB0aGlzLnBhcmVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBmbik7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgaW5zcGVjdChjb2xsYXBzZWQpIHtcclxuICAgICAgY29uc29sZVtjb2xsYXBzZWQgPT09IHRydWUgPyAnZ3JvdXBDb2xsYXBzZWQnIDogJ2dyb3VwJ10odGhpcy50eXBlKTtcclxuICAgICAgY29uc29sZS50YWJsZShcclxuICAgICAgICBPYmplY3Qua2V5cyh0aGlzKS5tYXAoa2V5ID0+IHtcclxuICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHByb3A6IGtleSxcclxuICAgICAgICAgICAgdmFsdWU6IHRoaXNba2V5XSxcclxuICAgICAgICAgICAgdHlwZTogdHlwZW9mIHRoaXNba2V5XVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICk7XHJcbiAgICAgIGNvbnNvbGUubG9nKHRoaXMucGFyZW50KTtcclxuICAgICAgY29uc29sZS5sb2codGhpcy5jaGlsZHJlbik7XHJcbiAgICAgIGNvbnNvbGUud2FybihEYXRlLm5vdygpLnRvU3RyaW5nKCkpO1xyXG4gICAgICBjb25zb2xlLmdyb3VwRW5kKHRoaXMudHlwZSk7XHJcbiAgXHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG4gIFxyXG59XG5cbmNsYXNzIENhcm91c2VsIGV4dGVuZHMgU2xpZGVyIHtcclxuXHJcbiAgY29uc3RydWN0b3IoY29uZmlnKSB7XHJcbiAgICBjb25maWcucGFyZW50U2VsZWN0b3IgPSBjb25maWcucGFyZW50U2VsZWN0b3IgfHwgJy5jYXJvdXNlbCc7XHJcbiAgICBzdXBlcihjb25maWcpO1xyXG4gICAgdGhpcy50eXBlID0gJ0Nhcm91c2VsJztcclxuICAgIHRoaXMuc2l6ZSA9IGNvbmZpZy5zaXplIHwgMDtcclxuICAgIHRoaXMuY29tcG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgY29tcG9zZSgpIHtcclxuICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5pbmRleCArIDE7XHJcbiAgICB0aGlzLmZvckVhY2goKHNsaWRlLCBpKSA9PiB7XHJcbiAgICAgIGxldCBpdGVtT3JkZXIgPSBpIC0gcG9zaXRpb24gKyAxO1xyXG4gICAgICBpZiAoaXRlbU9yZGVyIDwgMCkgaXRlbU9yZGVyID0gdGhpcy5sZW5ndGggLSBwb3NpdGlvbiArIGkgKyAxO1xyXG4gICAgICBzbGlkZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtb3JkZXInLCBpdGVtT3JkZXIpO1xyXG5cclxuICAgICAgc2xpZGUuY2xhc3NMaXN0LnJlbW92ZSgncHJldicpO1xyXG4gICAgICBzbGlkZS5jbGFzc0xpc3QucmVtb3ZlKCdjdXJyZW50Jyk7XHJcbiAgICAgIHNsaWRlLmNsYXNzTGlzdC5yZW1vdmUoJ25leHQnKTtcclxuICAgICAgc2xpZGUuY2xhc3NMaXN0LnJlbW92ZSgnd2lsbC1nby1wcmV2Jyk7XHJcbiAgICAgIHNsaWRlLmNsYXNzTGlzdC5yZW1vdmUoJ3dpbGwtZ28tbmV4dCcpO1xyXG5cclxuICAgICAgaWYgKHRoaXMuc2l6ZSkge1xyXG4gICAgICAgIGNvbnN0IGNsYXNzTmFtZSA9XHJcbiAgICAgICAgICB0aGlzLmxlbmd0aCA8PSB0aGlzLnNpemUgPyAnY3VycmVudCcgOlxyXG4gICAgICAgICAgaXRlbU9yZGVyID4gLTEgJiYgaXRlbU9yZGVyIDwgdGhpcy5zaXplID8gJ2N1cnJlbnQnIDpcclxuICAgICAgICAgIGl0ZW1PcmRlciA9PT0gLTEgfHwgaXRlbU9yZGVyID09PSB0aGlzLmxlbmd0aCAtIDEgPyAncHJldicgOlxyXG4gICAgICAgICAgaXRlbU9yZGVyID09PSB0aGlzLnNpemUgPyAnbmV4dCcgOlxyXG4gICAgICAgICAgJyc7XHJcbiAgICAgICAgaWYgKCFjbGFzc05hbWUpIHJldHVybiB0aGlzO1xyXG4gICAgICAgIHNsaWRlLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcclxuICAgICAgICBzbGlkZS5zdHlsZS5vcmRlciA9IGl0ZW1PcmRlcjtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKHRoaXMuZGlyKSB7XHJcbiAgICAgICAgY29uc3QgYW5pbUNsYXNzTmFtZSA9ICd3aWxsLWdvLScgKyB0aGlzLmRpcjtcclxuICAgICAgICBzbGlkZS5jbGFzc0xpc3QuYWRkKGFuaW1DbGFzc05hbWUpO1xyXG4gICAgICAgIHNsaWRlLmFkZEV2ZW50TGlzdGVuZXIoXCJ3ZWJraXRBbmltYXRpb25FbmRcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICByZW1vdmVXaWxsUmVuZGVyQ2xhc3Moc2xpZGUsIGFuaW1DbGFzc05hbWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHNsaWRlLmFkZEV2ZW50TGlzdGVuZXIoXCJhbmltYXRpb25lbmRcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICByZW1vdmVXaWxsUmVuZGVyQ2xhc3Moc2xpZGUsIGFuaW1DbGFzc05hbWUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgZnVuY3Rpb24gcmVtb3ZlV2lsbFJlbmRlckNsYXNzKHNsaWRlLCBjbGFzc05hbWUpIHtcclxuICAgICAgc2xpZGUuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgcHJldigpIHtcclxuICAgIHRoaXMuZGlyID0gJ3ByZXYnO1xyXG4gICAgcmV0dXJuIHN1cGVyLnByZXYoKTtcclxuICB9XHJcblxyXG4gIG5leHQoKSB7XHJcbiAgICB0aGlzLmRpciA9ICduZXh0JztcclxuICAgIHJldHVybiBzdXBlci5uZXh0KCk7XHJcbiAgfVxyXG5cclxuICBnb1RvKGluZGV4KSB7XHJcbiAgICB0aGlzLmRpciA9IGluZGV4ID4gdGhpcy5pbmRleCA/ICduZXh0JyA6ICdwcmV2JztcclxuICAgIHJldHVybiBzdXBlci5nb1RvKGluZGV4KTtcclxuICB9XHJcblxyXG59XG5cbmNvbnN0IG1hc2tzID0ge1xyXG5cclxuICAgIHRlbGVmb25lOiBjYW1wbyA9PiB7XHJcbiAgICAgIGNvbnN0IHJlZ3JhcyA9IFsvXFxkKy9naSwgL14oXFxkXFxkPykvLCAvXihcXGRcXGQpKFxcZHs0fSktPyhcXGR7MSw0fSkvLCAvXihcXGRcXGQpKFxcZHs1fSktPyhcXGR7MSw0fSkvXTtcclxuICAgICAgY29uc3QgdmFsb3JlcyA9IGNhbXBvLnZhbHVlLm1hdGNoKHJlZ3Jhc1swXSk7XHJcbiAgICAgIGlmICghdmFsb3JlcykgcmV0dXJuIGNhbXBvLnZhbHVlID0gJyc7XHJcbiAgICAgIGNvbnN0IHZhbG9yID0gY2FtcG8udmFsdWUgPSB2YWxvcmVzLmpvaW4oJycpO1xyXG4gICAgICBpZiAodmFsb3IubGVuZ3RoID4gMCkgY2FtcG8udmFsdWUgPSB2YWxvci5yZXBsYWNlKHJlZ3Jhc1sxXSwgJygkMScpO1xyXG4gICAgICBpZiAodmFsb3IubGVuZ3RoID4gMikgY2FtcG8udmFsdWUgPSB2YWxvci5yZXBsYWNlKHJlZ3Jhc1sxXSwgJygkMSkgJyk7XHJcbiAgICAgIGlmICh2YWxvci5sZW5ndGggPiA2KSBjYW1wby52YWx1ZSA9IHZhbG9yLnJlcGxhY2UocmVncmFzWzJdLCAnKCQxKSAkMi0kMycpO1xyXG4gICAgICBpZiAodmFsb3IubGVuZ3RoID4gMTApIGNhbXBvLnZhbHVlID0gdmFsb3IucmVwbGFjZShyZWdyYXNbM10sICcoJDEpICQyLSQzJyk7XHJcbiAgICAgIGlmICh2YWxvci5sZW5ndGggPiAxMSkgY2FtcG8udmFsdWUgPSBjYW1wby52YWx1ZS5zdWJzdHIoMCwgMTUpO1xyXG4gICAgfSxcclxuICBcclxuICAgIGNwZjogY2FtcG8gPT4ge1xyXG4gICAgICBjb25zdCBudW1lcm9zID0gL1xcZCsvZ2k7XHJcbiAgICAgIGNvbnN0IHZhbG9yZXMgPSBjYW1wby52YWx1ZS5tYXRjaChudW1lcm9zKTtcclxuICAgICAgaWYgKCF2YWxvcmVzKSByZXR1cm4gY2FtcG8udmFsdWUgPSAnJztcclxuICAgICAgY29uc3QgdmFsb3IgPSB2YWxvcmVzLmpvaW4oJycpO1xyXG4gICAgICBjb25zdCBjcGYgPSAvXihbMC05XXsxLDN9KT9cXC4/KFswLTldezEsM30pP1xcLj8oWzAtOV17MSwzfSk/LT8oWzAtOV17MSwyfSk/JC87XHJcbiAgICAgIGNvbnN0IGNucGogPSAvXihbMC05XXsxLDJ9KT9cXC4/KFswLTldezEsM30pP1xcLj8oWzAtOV17MSwzfSk/XFwvPyhbMC05XXsxLDR9KT8tPyhbMC05XXsxLDJ9KT8kLztcclxuICAgICAgY2FtcG8udmFsdWUgPSBjYW1wby52YWx1ZS5yZXBsYWNlKC9bXlxcZC4vLV0vZ2ksICcnKTtcclxuICAgICAgaWYgKGNwZi50ZXN0KHZhbG9yKSkgY2FtcG8udmFsdWUgPSB2YWxvci5yZXBsYWNlKGNwZiwgKGFsbCwgYSwgYiwgYywgZCkgPT4ge1xyXG4gICAgICAgIHJldHVybiAoYSB8fCAnJykgKyAoYiA/ICcuJyArIGIgOiAnJykgKyAoYyA/ICcuJyArIGMgOiAnJykgKyAoZCA/ICctJyArIGQgOiAnJyk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBlbHNlIGlmIChjbnBqLnRlc3QodmFsb3IpKSBjYW1wby52YWx1ZSA9IHZhbG9yLnJlcGxhY2UoY25waiwgKGFsbCwgYSwgYiwgYywgZCwgZSkgPT4ge1xyXG4gICAgICAgIHJldHVybiAoYSB8fCAnJykgKyAoYiA/ICcuJyArIGIgOiAnJykgKyAoYyA/ICcuJyArIGMgOiAnJykgKyAoZCA/ICcvJyArIGQgOiAnJykgKyAoZSA/ICctJyArIGUgOiAnJyk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBpZiAoY2FtcG8udmFsdWUubGVuZ3RoID4gMTgpIGNhbXBvLnZhbHVlID0gY2FtcG8udmFsdWUuc3Vic3RyKDAsIDE4KTtcclxuICAgIH0sXHJcbiAgXHJcbiAgICBkYXRhOiBjYW1wbyA9PiB7XHJcbiAgICAgIGlmIChjYW1wby50eXBlID09PSAnZGF0ZScpIHJldHVybjtcclxuICAgICAgY29uc3QgbnVtZXJvcyA9IGNhbXBvLnZhbHVlLnJlcGxhY2UoL14wP1xcL3xbXlxcZC9dL2dpLCAnJyk7XHJcbiAgICAgIGlmIChudW1lcm9zID09PSAnJykge1xyXG4gICAgICAgIGNhbXBvLnZhbHVlID0gbnVtZXJvcztcclxuICAgICAgICBjYW1wby5zdHlsZS5ib3JkZXJDb2xvciA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGNhbXBvLnZhbHVlID0gbnVtZXJvc1xyXG4gICAgICAgIC5yZXBsYWNlKC8oXnxcXC8pMDArXFwvPy9nLCAnMCcpXHJcbiAgICAgICAgLnJlcGxhY2UoLyhefFxcLykoWzEtOV1cXC8pLywgJzAkMicpXHJcbiAgICAgICAgLnJlcGxhY2UoXHJcbiAgICAgICAgICAvKFxcZFxcZCkoXFwvPykoXFxkezEsMn0pPyhcXC8/KTAqKFxcZHsxLDR9KT8uKi9nLFxyXG4gICAgICAgICAgZnVuY3Rpb24gKGFsbCwgZGQsIHMxLCBtbSwgczIsIGFhYWEpIHtcclxuICAgICAgICAgICAgaWYgKGRkID4gMzEgfHwgbW0gPiAxMikgY2FtcG8uc3R5bGUuYm9yZGVyQ29sb3IgPSAncmVkJztcclxuICAgICAgICAgICAgZWxzZSBjYW1wby5zdHlsZS5ib3JkZXJDb2xvciA9IG51bGw7XHJcbiAgICAgICAgICAgIHJldHVybiBkZCArIChtbSA/ICcvJyArIG1tIDogczEgfHwgJycpICsgKGFhYWEgPyAnLycgKyBhYWFhIDogczIgfHwgJycpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcbiAgICB9LFxyXG4gIFxyXG4gICAgbnVtZXJvczogY2FtcG8gPT4ge1xyXG4gICAgICBpZiAoIS9eWzAtOV0rJC8udGVzdChjYW1wby52YWx1ZSkpIHtcclxuICAgICAgICBjYW1wby52YWx1ZSA9IGNhbXBvLnZhbHVlLnN1YnN0cmluZygwLCBjYW1wby52YWx1ZS5sZW5ndGggLSAxKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIFxyXG4gIH07XG5cbmZ1bmN0aW9uIF9tYXAod2hhdCwgY2FsbGJhY2spIHtcclxuICAgIGlmICh0eXBlb2Ygd2hhdCA9PT0gJ3N0cmluZycpIHdoYXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHdoYXQpO1xyXG4gICAgaWYgKCEod2hhdCBpbnN0YW5jZW9mIEFycmF5KSkgd2hhdCA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKHdoYXQpO1xyXG4gICAgaWYgKGNhbGxiYWNrIGluc3RhbmNlb2YgRnVuY3Rpb24pIHdoYXQgPSB3aGF0Lm1hcCh3ID0+IGNhbGxiYWNrKHcpKTtcclxuICAgIHJldHVybiB3aGF0O1xyXG4gIH1cclxuICBcclxuICBmdW5jdGlvbiBzY3JlZW4oKSB7XHJcbiAgICBjb25zdCB3ID0gd2luZG93LFxyXG4gICAgICBkID0gZG9jdW1lbnQsXHJcbiAgICAgIGUgPSBkLmRvY3VtZW50RWxlbWVudCxcclxuICAgICAgZyA9IGQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXSxcclxuICAgICAgd2lkdGggPSB3LmlubmVyV2lkdGggfHwgZS5jbGllbnRXaWR0aCB8fCBnLmNsaWVudFdpZHRoLFxyXG4gICAgICBoZWlnaHQgPSB3LmlubmVySGVpZ2h0IHx8IGUuY2xpZW50SGVpZ2h0IHx8IGcuY2xpZW50SGVpZ2h0O1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgd2lkdGgsXHJcbiAgICAgIGhlaWdodFxyXG4gICAgfVxyXG4gIH1cblxuY29uc3Qgc2xpZGVyT3B0aW9ucyA9IHtcclxuICBhdXRvcGxheTogc2xpZGVyID0+IHtcclxuICAgIHNsaWRlclxyXG4gICAgICAucGxheSgpXHJcbiAgICAgIC5vbignbW91c2VvdmVyJywgKCkgPT4gc2xpZGVyLnBhdXNlKCkpXHJcbiAgICAgIC5vbignbW91c2VvdXQnLCAoKSA9PiBzbGlkZXIucGxheSgpKTtcclxuICB9XHJcbn07XHJcblxyXG5mdW5jdGlvbiBzZXR1cCgpIHtcclxuXHJcbiAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKFwidG91Y2hzdGFydFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiBmYWxzZVxyXG4gIH0pO1xyXG5cclxuICBjb25zdCBvZmZzZXRIZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2l0ZS1oZWFkZXInKS5vZmZzZXRIZWlnaHQ7XHJcbiAgY29uc3QgcGFnZUxpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYVtocmVmXj1cIicgKyBiYXNldXJsICsgJy8jXCJdLnNjcm9sbCcpO1xyXG4gIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwocGFnZUxpbmtzLCBsaW5rID0+IGxpbmsuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKCl7XHJcbiAgICAgIGNvbnN0IHNlY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuaGFzaCk7XHJcbiAgICAgIGlmICghc2VjdGlvbikgcmV0dXJuIGZhbHNlO1xyXG4gICAgICBzY3JvbGxUb1koc2VjdGlvbi5vZmZzZXRUb3AgLSBvZmZzZXRIZWFkZXIsIDEwMDApO1xyXG4gIH0pKTsgIFxyXG5cclxuICB3aW5kb3cuc2xpZGVycyA9IF9tYXAoJy5zbGlkZXInLCBwYXJlbnQgPT4ge1xyXG4gICAgY29uc3Qgc2xpZGVyID0gbmV3IFNsaWRlcih7XHJcbiAgICAgIHBhcmVudFxyXG4gICAgfSk7XHJcbiAgICBjb25maWdTbGlkZXIoc2xpZGVyLCBwYXJlbnQpO1xyXG4gIH0pO1xyXG5cclxuICB3aW5kb3cuY2Fyb3VzZWxzID0gX21hcCgnLmNhcm91c2VsJywgcGFyZW50ID0+IHtcclxuICAgIGNvbnN0IHNpemUgPSBwYXJlbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXNpemUnKSB8IDA7XHJcbiAgICBjb25zdCBjYXJvdXNlbCA9IG5ldyBDYXJvdXNlbCh7XHJcbiAgICAgIHBhcmVudCxcclxuICAgICAgc2l6ZVxyXG4gICAgfSk7XHJcbiAgICBjb25maWdTbGlkZXIoY2Fyb3VzZWwsIHBhcmVudCk7XHJcbiAgICByZXR1cm4gY2Fyb3VzZWw7XHJcbiAgfSk7XHJcblxyXG4gIF9tYXAoJ1tkYXRhLW1hc2tdJywgY2FtcG8gPT4ge1xyXG4gICAgY29uc3QgbmFtZSA9IGNhbXBvLmdldEF0dHJpYnV0ZSgnZGF0YS1tYXNrJyk7XHJcbiAgICBpZiAoIW5hbWUpIHJldHVybjtcclxuICAgIGlmICghbWFza3NbbmFtZV0gfHwgIShtYXNrc1tuYW1lXSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSkgcmV0dXJuO1xyXG4gICAgY2FtcG8uYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIG1hc2tzW25hbWVdKGNhbXBvKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBfbWFwKCdbZGF0YS1zY3JpcHRdJywgaXRlbSA9PiB7XHJcbiAgICBjb25zdCB2YWx1ZUZuID0gaXRlbS5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNjcmlwdFwiKTtcclxuICAgIGlmICghdmFsdWVGbikgcmV0dXJuO1xyXG4gICAgaWYgKCFpdGVtLnZhbHVlKSByZXR1cm47XHJcbiAgICB3aW5kb3dbdmFsdWVGbl0oMCwgaXRlbS52YWx1ZSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbndpbmRvdy5zZXR1cCA9IHNldHVwO1xyXG5cclxuZnVuY3Rpb24gY29uZmlnU2xpZGVyKHNsaWRlciwgcGFyZW50KSB7XHJcbiAgY29uc3QgZmlyc3QgPSBwYXJlbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWZpcnN0JykgfCAwO1xyXG4gIGlmIChmaXJzdCkge1xyXG4gICAgc2xpZGVyLmdvVG8oZmlyc3QpO1xyXG4gIH1cclxuXHJcbiAgY29uc3Qgb3B0aW9ucyA9IHBhcmVudC5oYXNBdHRyaWJ1dGUoJ2RhdGEtb3B0aW9ucycpID8gcGFyZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1vcHRpb25zJykuc3BsaXQoJyAnKSA6IFtdO1xyXG4gIG9wdGlvbnMuZm9yRWFjaChvcHRpb24gPT4gc2xpZGVyT3B0aW9uc1tvcHRpb25dICYmIHNsaWRlck9wdGlvbnNbb3B0aW9uXShzbGlkZXIpKTtcclxuXHJcbiAgY29uc3Qgc2xpZGVyQ2FsbGJhY2tzID0ge1xyXG4gICAgb3Blbk9uTW9iaWxlOiAoKSA9PiB7XHJcbiAgICAgIGlmIChzY3JlZW4oKS53aWR0aCA+IDYwMCkgcmV0dXJuO1xyXG4gICAgICBjb25zdCBmaXJzdCA9IHNsaWRlci5maW5kKHNsaWRlID0+IHNsaWRlLmdldEF0dHJpYnV0ZSgnZGF0YS1vcmRlcicpID09PSAnMCcpO1xyXG4gICAgICBpZiAoIWZpcnN0KSByZXR1cm47XHJcbiAgICAgIGNvbnN0IGJ0biA9IGZpcnN0LnF1ZXJ5U2VsZWN0b3IoJy5pbmZvLWltZyBhW2hyZWZePVwiamF2YXNjcmlwdDpcIl0nKTtcclxuICAgICAgaWYgKCFidG4pIHJldHVybjtcclxuICAgICAgYnRuLmNsaWNrKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX21hcCgnW2RhdGEtY29udHJvbF0nLCBjb250cm9sID0+IHtcclxuICAgIGNvbnN0IHRhcmdldCA9IGNvbnRyb2wuZ2V0QXR0cmlidXRlKCdkYXRhLWNvbnRyb2wnKTtcclxuICAgIGNvbnN0IHRhcmdldEVsZW1lbnQgPSB0YXJnZXQgPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhcmdldCkgOiBudWxsO1xyXG5cclxuICAgIGlmICh0YXJnZXRFbGVtZW50ICYmIHRhcmdldEVsZW1lbnQgPT09IHNsaWRlci5wYXJlbnQpIHtcclxuICAgICAgY29uc3QgYWN0aW9uID0gY29udHJvbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtYWN0aW9uJyk7XHJcbiAgICAgIGlmICgoYWN0aW9uID09PSAncHJldicgfHwgYWN0aW9uID09PSAnbmV4dCcpICYmIChzbGlkZXIuc2l6ZSA+PSBzbGlkZXIubGVuZ3RoKSkge1xyXG4gICAgICAgIGNvbnRyb2wuc2V0QXR0cmlidXRlKCdkYXRhLW92ZXJzaXplJywgdHJ1ZSk7XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgYWN0aW9uRGF0YSA9IGNvbnRyb2wuZ2V0QXR0cmlidXRlKCdkYXRhLXBhcmFtcycpO1xyXG4gICAgICBjb25zdCBwYXJhbXMgPSBhY3Rpb25EYXRhID8gYWN0aW9uRGF0YS5zcGxpdCgnLCcpIDogbnVsbDtcclxuICAgICAgY29uc3QgY2FsbGJhY2sgPSBjb250cm9sLmdldEF0dHJpYnV0ZSgnZGF0YS1jYWxsYmFjaycpO1xyXG4gICAgICBpZiAoYWN0aW9uICYmIHNsaWRlclthY3Rpb25dIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgICAgICBjb250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgc2xpZGVyW2FjdGlvbl0uYXBwbHkoc2xpZGVyLCBwYXJhbXMpO1xyXG4gICAgICAgICAgaWYgKGNhbGxiYWNrICYmIHNsaWRlckNhbGxiYWNrc1tjYWxsYmFja10pIHNsaWRlckNhbGxiYWNrc1tjYWxsYmFja10oKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICB9KTtcclxufVxyXG5cclxud2luZG93Lm1vZGFsID0gZnVuY3Rpb24gbW9kYWwobW9kYWwpIHtcclxuICBpZiAodHlwZW9mIG1vZGFsID09PSAnc3RyaW5nJykgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG1vZGFsKTtcclxuICByZXR1cm4ge1xyXG4gICAgYWJyaXI6IGZ1bmN0aW9uKCkge21vZGFsLmNsYXNzTGlzdC5hZGQoJ3RhcmdldCcpO30sXHJcbiAgICBmZWNoYXI6IGZ1bmN0aW9uKCkge21vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3RhcmdldCcpO31cclxuICB9O1xyXG59O1xuXG59KCkpO1xuIl19
